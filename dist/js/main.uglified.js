function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function i18nParam(e,t){var n=i18n[e];return angular.forEach(t,function(e,t){n=n.replace("%"+t+"%",e)}),n}function typeCastValue(e){return angular.isNumber(e)?parseInt(e):e}angular.module("dnd",[]).factory("dndFactory",function(){return{data:{content:null,pos:null,element:null},getElement:function(){return this.data.element},setElement:function(e){this.data.element=e},setContent:function(e){this.data.content=e},getContent:function(){return this.data.content},setPos:function(e){this.data.pos=e},getPos:function(){return this.data.pos}}}).directive("dnd",["dndFactory","AdminClassService",function(r,e){return{restrict:"A",transclude:!1,replace:!1,template:!1,templateURL:!1,scope:{dndModel:"=",dndCss:"=",dndOndrop:"&",dndIsvalid:"&"},link:function(a,i,e){var o=!0,l=e.hasOwnProperty("dndDisableDragMiddle");e.hasOwnProperty("dndDragDisabled")||i.attr("draggable","true"),a.addClass=function(e){i.addClass(e)},a.removeClass=function(e,t){i.removeClass(e)},i.on("dragstart",function(e){if((e=e.originalEvent||e).stopPropagation(),"false"==i.attr("draggable"))return!0;o=!0,r.setContent(a.dndModel),r.setElement(i[0]),a.addClass(a.dndCss.onDrag);try{e.dataTransfer.setData("text","1")}catch(e){try{e.dataTransfer.setData("application/json","1")}catch(e){e.dataTransfer.setData("Text","1")}}}),i.on("dragend",function(e){e=e.originalEvent||e,a.removeClass(a.dndCss.onDrag),e.stopPropagation()}),i.on("dragover",function(e){e=e.originalEvent||e;try{e.dataTransfer.dropEffect="move"}catch(e){}if(e.preventDefault(),e.stopPropagation(),!a.dndIsvalid({hover:a.dndModel,dragged:r.getContent()}))return o=!1;var t=i[0].getBoundingClientRect(),n=100/t.height*(e.clientY-t.top);return l?n<=50?(a.addClass(a.dndCss.onHoverTop),a.removeClass(a.dndCss.onHoverMiddle),a.removeClass(a.dndCss.onHoverBottom),r.setPos("top")):(a.removeClass(a.dndCss.onHoverTop),a.removeClass(a.dndCss.onHoverMiddle),a.addClass(a.dndCss.onHoverBottom),r.setPos("bottom")):n<=25?(a.addClass(a.dndCss.onHoverTop),a.removeClass(a.dndCss.onHoverMiddle),a.removeClass(a.dndCss.onHoverBottom),r.setPos("top")):65<=n?(a.removeClass(a.dndCss.onHoverTop),a.removeClass(a.dndCss.onHoverMiddle),a.addClass(a.dndCss.onHoverBottom),r.setPos("bottom")):(a.removeClass(a.dndCss.onHoverTop),a.addClass(a.dndCss.onHoverMiddle),a.removeClass(a.dndCss.onHoverBottom),r.setPos("middle")),a.addClass(a.dndCss.onHover),!1}),i.on("dragenter",function(e){e=e.originalEvent||e,a.addClass(a.dndCss.onHover),e.preventDefault()}),i.on("dragleave",function(e){a.removeClass(a.dndCss.onHover,!0),a.removeClass(a.dndCss.onHoverTop,!0),a.removeClass(a.dndCss.onHoverMiddle,!0),a.removeClass(a.dndCss.onHoverBottom,!0)}),e.hasOwnProperty("dndDropDisabled")||i.on("drop",function(e){return(e=e.originalEvent||e).preventDefault(),e.stopPropagation(),a.removeClass(a.dndCss.onHover,!0),a.removeClass(a.dndCss.onHoverTop,!0),a.removeClass(a.dndCss.onHoverMiddle,!0),a.removeClass(a.dndCss.onHoverBottom,!0),!!o&&(a.$apply(function(){a.dndOndrop({dragged:r.getContent(),dropped:a.dndModel,position:r.getPos(),element:r.getElement()})}),!0)})}}}]);var zaa=angular.module("zaa",["ui.router","dnd","angular-loading-bar","ngFileUpload","ngWig","flow","angular.filter","720kb.datepicker","directive.ngColorwheel"]);zaa.config(["$httpProvider","$stateProvider","$controllerProvider","$urlMatcherFactoryProvider",function(e,t,n,a){e.interceptors.push("authInterceptor"),zaa.bootstrap=n,a.strictMode(!1),t.state("default",{url:"/default/:moduleId",templateUrl:function(e){return"admin/template/default"}}).state("default.route",{url:"/:moduleRouteId/:controllerId/:actionId",templateUrl:function(e){return e.moduleRouteId+"/"+e.controllerId+"/"+e.actionId},parent:"default",resolve:{adminServiceResolver:adminServiceResolver}}).state("custom",{url:"/template/:templateId",templateUrl:function(e){return e.templateId},resolve:{adminServiceResolver:adminServiceResolver,resolverProvider:["resolver",function(e){return e.then}]}}).state("home",{url:"",templateUrl:"admin/default/dashboard"}).state("default.route.detail",{url:"/:id",parent:"default.route",template:"<ui-view/>",controller:["$scope","$stateParams",function(e,t){e.crud=e.$parent,e.init=function(){e.crud.config.inline||e.crud.data.updateId!=t.id&&e.crud.toggleUpdate(t.id)},e.init()}]})}]),zaa.provider("resolver",[function(){var i=[];this.addCallback=function(e){i.push(e)},this.$get=["$injector","$q","$state",function(a,e,t){return e(function(e,t){for(var n in i)a.invoke(i[n])})}]}]),zaa.factory("LuyaLoading",["$timeout",function(t){var n=!1,a=null,i=null;return{start:function(e){a=null==e?i18n.js_zaa_server_proccess:e,t.cancel(i),i=t(function(){n=!0},2e3)},stop:function(){t.cancel(i),n=!1},getStateMessage:function(){return a},getState:function(){return n}}}]),zaa.factory("AdminClassService",function(){var n=[];return n.vars={},n.getClassSpace=function(e){if(n.vars.hasOwnProperty(e))return n.vars[e]},n.hasClassSpace=function(e){return!!n.vars.hasOwnProperty(e)},n.setClassSpace=function(e,t){n.vars[e]=t},n.clearSpace=function(e){n.vars.hasOwnProperty(e)&&(n.vars[e]=null)},n.removeSpace=function(e){n.hasClassSpace(e)&&delete n.vars[e]},n.stack=0,n.modalStackPush=function(){n.stack+=1},n.modalStackRemove=function(){n.stack<=1?n.stack=0:n.stack-=1},n.modalStackRemoveAll=function(){n.stack=0},n.modalStackIsEmpty=function(){return 0==n.stack},n}),zaa.factory("CacheReloadService",["$http","$window",function(e,t){var n=[];return n.reload=function(){e.get("admin/api-admin-common/cache").then(function(e){t.location.reload()})},n}]),zaa.factory("authInterceptor",["$rootScope","$q","AdminToastService","AdminDebugBar",function(a,i,t,o){return{request:function(e){if(e.hasOwnProperty("ignoreLoadingBar")||(e.debugId=o.pushRequest(e)),e.hasOwnProperty("authToken"))var t=e.authToken;else t=a.luyacfg.authToken;e.headers=e.headers||{},e.headers.Authorization="Bearer "+t;var n=document.head.querySelector("[name=csrf-token]").content;return e.headers["X-CSRF-Token"]=n,e||i.when(e)},response:function(e){return e.hasOwnProperty("ignoreLoadingBar")||o.pushResponse(e),e||i.when(e)},responseError:function(e){if(401==e.status||403==e.status||405==e.status)e.config.hasOwnProperty("authToken")||(window.location="admin/default/logout");else if(422!=e.status){e.data.hasOwnProperty("message")?t.error(e.data.message,1e4):t.error("Response Error: "+e.status+" "+e.statusText,1e4)}return i.reject(e)}}}]),adminServiceResolver=["ServiceFoldersData","ServiceImagesData","ServiceFilesData","ServiceFiltersData","ServiceLanguagesData","ServicePropertiesData","AdminLangService","ServiceFoldersDirecotryId",function(e,t,n,a,i,o,l,r){a.load(),e.load(),t.load(),n.load(),i.load(),o.load(),l.load(),r.load()}],zaa.factory("ServiceFoldersData",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.data=null,o.load=function(n){return e(function(t,e){null!==o.data&&!0!==n?t(o.data):a.get("admin/api-admin-storage/data-folders").then(function(e){o.data=e.data,i.$broadcast("service:FoldersData",o.data),t(o.data)})})},o}]),zaa.factory("ServiceFoldersDirecotryId",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.folderId=!1,o.load=function(n){return e(function(t,e){!1!==o.folderId&&!0!==n?t(o.folderId):a.get("admin/api-admin-common/get-filemanager-folder-state").then(function(e){o.folderId=e.data,i.$broadcast("service:FoldersDirectoryId",o.folderId),t(o.folderId)})})},o}]),zaa.factory("ServiceImagesData",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.data=null,o.load=function(n){return e(function(t,e){null!==o.data&&!0!==n?t(o.data):a.get("admin/api-admin-storage/data-images").then(function(e){o.data=e.data,i.$broadcast("service:ImagesData",o.data),t(o.data)})})},o}]),zaa.factory("ServiceFilesData",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.data=null,o.load=function(n){return e(function(t,e){null!==o.data&&!0!==n?t(o.data):a.get("admin/api-admin-storage/data-files").then(function(e){o.data=e.data,i.$broadcast("service:FilesData",o.data),t(o.data)})})},o}]),zaa.factory("ServiceFiltersData",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.data=null,o.load=function(n){return e(function(t,e){null!==o.data&&!0!==n?t(o.data):a.get("admin/api-admin-storage/data-filters").then(function(e){o.data=e.data,i.$broadcast("service:FiltersData",o.data),t(o.data)})})},o}]),zaa.factory("ServiceLanguagesData",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.data=[],o.load=function(n){return e(function(t,e){0<o.data.length&&!0!==n?t(o.data):a.get("admin/api-admin-common/data-languages").then(function(e){o.data=e.data,i.$broadcast("service:LanguagesData",o.data),t(o.data)})})},o}]),zaa.factory("ServicePropertiesData",["$http","$q","$rootScope",function(a,e,i){var o=[];return o.data=null,o.load=function(n){return e(function(t,e){null!==o.data&&!0!==n?t(o.data):a.get("admin/api-admin-common/data-properties").then(function(e){o.data=e.data,i.$broadcast("service:PropertiesData",o.data),t(o.data)})})},o}]),zaa.factory("CrudTabService",function(){var l=[];return l.tabs=[],l.remove=function(e,t){(l.tabs.splice(e,1),0<l.tabs.length)?l.tabs.slice(-1)[0].active=!0:t.switchTo(0)},l.addTab=function(e,t,n,a,i){var o={id:e,api:t,arrayIndex:n,active:!0,name:a,modelClass:i};angular.forEach(l.tabs,function(e){e.active=!1}),l.tabs.push(o)},l.clear=function(){l.tabs=[]},l}),zaa.factory("AdminLangService",["ServiceLanguagesData","$rootScope",function(e,n){var a=[];return a.data=[],a.selection=[],a.toggleSelection=function(e){var t=a.selection.indexOf(e.short_code);-1==t?(a.selection.push(e.short_code),n.$broadcast("service:LoadLanguage",e)):1<a.selection.length&&a.selection.splice(t,1)},a.isInSelection=function(e){return-1!=a.selection.indexOf(e)},a.resetDefault=function(){a.selection=[],angular.forEach(e.data,function(e,t){1==e.is_default&&(a.isInSelection(e.short_code)||a.toggleSelection(e))})},a.load=function(){e.load().then(function(e){a.data=e,angular.forEach(e,function(e){1==e.is_default&&(a.isInSelection(e.short_code)||a.toggleSelection(e))})})},a}]),zaa.factory("AdminDebugBar",function(){var a=[];return a.data=[],a.clear=function(){a.data=[]},a.pushRequest=function(e){return a.data.push({url:e.url,requestData:e.data,responseData:null,responseStatus:null,start:new Date,end:null,parseTime:null})},a.pushResponse=function(e){var t=e,n=a.data[t.config.debugId];return n&&(n.responseData=t.data,n.responseStatus=t.status,n.end=new Date,n.parseTime=new Date-n.start),e},a}),zaa.factory("AdminToastService",["$q","$timeout","$injector",function(e,i,o){var l=[];return l.notify=function(e,t,n){null==t&&(t=6e3);var a=guid();l.queue[a]={message:e,timeout:t,uuid:a,type:n,close:function(){delete l.queue[this.uuid]}},i(function(){delete l.queue[a]},t)},l.success=function(e,t){l.notify(e,t,"success")},l.info=function(e,t){l.notify(e,t,"info")},l.warning=function(e,t){l.notify(e,t,"warning")},l.error=function(e,t){l.notify(e,t,"error")},l.errorArray=function(e,n){angular.forEach(e,function(e,t){l.error(e.message,n)})},l.confirm=function(e,t,n){var a=guid();l.queue[a]={message:e,title:t,click:function(){var t=this,e=o.invoke(this.callback,this,{$toast:this});void 0!==e&&e.then(function(e){t.close()},function(e){t.close()},function(e){})},uuid:a,callback:n,type:"confirm",close:function(){delete l.queue[this.uuid]}}},l.queue={},l}]),zaa.factory("HtmlStorage",function(){var n={data:{},isLoaded:!1,loadData:function(){if(!n.isLoaded&&localStorage.getItem("HtmlStorage")){var e=angular.fromJson(localStorage.getItem("HtmlStorage"));n.data=e}},saveData:function(){localStorage.removeItem("HtmlStorage"),localStorage.setItem("HtmlStorage",angular.toJson(n.data))},getValue:function(e,t){return n.loadData(),n.data.hasOwnProperty(e)?n.data[e]:t},setValue:function(e,t){n.loadData(),n.data[e]=t,n.saveData()}};return n}),zaa.filter("filemanagerdirsfilter",function(){return function(e,n){var a=[];return angular.forEach(e,function(e,t){e.parentId==n&&a.push(e)}),a}}),zaa.filter("findthumbnail",function(){return function(e,n,a){var i=!1;return angular.forEach(e,function(e,t){i||e.fileId==n&&e.filterId==a&&(i=e)}),i}}),zaa.filter("findidfilter",function(){return function(e,n){var a=!1;return angular.forEach(e,function(e,t){e.id==n&&(a=e)}),a}}),zaa.filter("filemanagerfilesfilter",function(){return function(e,t,n){var a=[];return angular.forEach(e,function(e){n?e.folderId==t&&1==e.isImage&&a.push(e):e.folderId==t&&a.push(e)}),a}}),zaa.filter("trustAsUnsafe",["$sce",function(n){return function(e,t){return n.trustAsHtml(e)}}]),zaa.filter("srcbox",function(){return function(e,t){if(!e)return e;if(!t)return e;var i=(""+t).toLowerCase(),o={};return angular.forEach(e,function(n,a){angular.forEach(n,function(e,t){-1!==(""+e).toLowerCase().indexOf(i)&&(o[a]=n)})}),o}}),zaa.filter("trustAsResourceUrl",["$sce",function(n){return function(e,t){return t?n.trustAsResourceUrl(e):null}}]),zaa.filter("truncateMiddle",function(){return function(e,t,n){if(t||(t=30),n||(n="..."),e.length<=t)return e;var a=(t-n.length)/2;return e.substring(0,a)+n+e.substring(e.length-a,e.length)}}),zaa.directive("echarts",function(){return{scope:{id:"@",legend:"=",item:"=",data:"="},restrict:"E",template:'<div style="min-height:300px;height:auto;width:100%;"></div>',replace:!0,link:function(t,e,n,a){var i=echarts.init(document.getElementById(t.id),"macarons");i.setOption({tooltip:{show:!0,trigger:"item"},legend:{data:[]}}),t.$watch("data",function(){var e=t.$eval("data");null!=e&&i.setOption(angular.fromJson(e))},!0),angular.element(window).bind("resize",function(){i.resize()})}}}),zaa.directive("compileHtml",["$compile","$parse",function(i,o){return{restrict:"A",link:function(e,t,n){var a=o(n.ngBindHtml);e.$watch(function(){return(a(e)||"").toString()},function(){i(t,null,-9999)(e)})}}}]),zaa.directive("zaaEsc",["$document",function(a){return function(t,e,n){a.on("keyup",function(e){27==e.keyCode&&t.$apply(function(){t.$eval(n.zaaEsc)})})}}]),zaa.directive("linkObjectToString",function(){return{restrict:"E",relace:!0,scope:{link:"="},template:function(){return'<span><span ng-if="link.type==1"><show-internal-redirection nav-id="link.value" /></span><span ng-if="link.type==2">{{link.value}}</span><span ng-if="link.type==3"><storage-file-display file-id="{{link.value}}"></storage-file-display></span><span ng-if="link.type==4">{{link.value}}</span><span ng-if="link.type==5">{{link.value}}</span></span>'}}}),zaa.directive("tooltip",["$document",function(l){return{restrict:"A",scope:{tooltipText:"@",tooltipExpression:"=",tooltipPosition:"@",tooltipOffsetTop:"@",tooltipOffsetLeft:"@",tooltipImageUrl:"@",tooltipDisabled:"="},link:function(a,i,e){var t={top:function(){var e=i[0].getBoundingClientRect();return{top:e.top-a.pop.outerHeight(),left:e.left+e.width/2-a.pop.outerWidth()/2}},bottom:function(){var e=i[0].getBoundingClientRect();return{top:e.top+e.height,left:e.left+e.width/2-a.pop.outerWidth()/2}},right:function(){var e=i[0].getBoundingClientRect();return{top:e.top+e.height/2-a.pop.outerHeight()/2,left:e.left+e.width}},left:function(){var e=i[0].getBoundingClientRect();return{top:e.top+e.height/2-a.pop.outerHeight()/2,left:e.left-a.pop.outerWidth()}}},o=function(){var e={};e="function"==typeof t[a.tooltipPosition]?t[a.tooltipPosition]():t.right(),"number"==typeof a.tooltipOffsetTop&&(e.top=e.top+a.tooltipOffsetTop),"number"==typeof a.tooltipOffsetLeft&&(e.left=e.left+a.tooltipOffsetLeft),a.pop.css(e)};i.on("mouseenter",function(){if(!a.pop&&(void 0===a.tooltipDisabled||!1===a.tooltipDisabled)){a.tooltipExpression&&(a.tooltipText=a.tooltipExpression);var e='<div class="tooltip tooltip-'+(a.tooltipPosition||"right")+(a.tooltipImageUrl?" tooltip-image":"")+'" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner">'+(a.tooltipText?'<span class="tooltip-text">'+a.tooltipText+"</span>":"")+"</div></div>",t=$(e);if(a.tooltipImageUrl){var n=new Image;n.onload=function(){o()},n.src=a.tooltipImageUrl,t.find(".tooltip-inner").append(n)}a.pop=t,l.find("body").append(a.pop),a.pop.hide()}!a.pop||void 0!==a.tooltipDisabled&&!1!==a.tooltipDisabled||(o(),i.parents().on("scroll",o),a.pop.show())}),i.on("mouseleave",function(){i.parents().off("scroll",o),a.pop&&a.pop.hide()}),a.$on("$destroy",function(){a.pop&&a.pop.remove()})}}}]),zaa.directive("convertToNumber",function(){return{require:"ngModel",link:function(e,t,n,a){a.$parsers.push(function(e){return null!=e?parseInt(e,10):null}),a.$formatters.push(function(e){return null!=e?""+e:null})}}}),zaa.directive("autoGrow",function(){return function(e,t,n){var a=null,i=function(){null==a&&(a=angular.element("<div></div>").css({position:"absolute",top:-1e4,left:-1e4,resize:"none"}),angular.element(document.body).append(a)),a.css({fontSize:t.css("font-size"),fontFamily:t.css("font-family"),lineHeight:t.css("line-height"),width:t.width(),paddingTop:t.css("padding-top"),paddingBottom:t.css("padding-bottom")});var e=t.val().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/\s{2,}/g,function(e){return function(e,t){for(var n=0,a="";n<t;n++)a+=e;return a}("&nbsp;",e.length-1)+" "});a.html(e),t.css("height",a.outerHeight()+10+"px")};t.bind("keyup keydown keypress change click",i),t.bind("blur",function(){null!=a&&(a.remove(),a=null)}),i()}}),zaa.directive("resizer",["$document",function(o){return{scope:{trigger:"@"},link:function(e,t,a){function n(e){$(a.resizerCover).show();var t=e.pageX,n=window.innerWidth;t<600&&(t=600),n-400<t&&(t=n-400);$(a.resizerLeft).width(),$(a.resizerRight).width();$(a.resizerLeft).css({width:t+"px"}),$(a.resizerRight).css({width:n-t+"px"})}function i(){$(a.resizerCover).hide(),o.unbind("mousemove",n),o.unbind("mouseup",i)}e.$watch("trigger",function(e,t){0==e&&($(a.resizerLeft).removeAttr("style"),$(a.resizerRight).removeAttr("style"))}),t.on("mousedown",function(e){e.preventDefault(),o.on("mousemove",n),o.on("mouseup",i)})}}}]),zaa.directive("ngConfirmClick",function(){return{link:function(t,e,n){var a=n.ngConfirmClick||"Are you sure?",i=n.confirmedClick;e.bind("click",function(e){window.confirm(a)&&t.$eval(i)})}}}),zaa.directive("focusMe",["$timeout","$parse",function(i,o){return{link:function(e,t,n){var a=o(n.focusMe);e.$watch(a,function(e){!0===e&&i(function(){t[0].focus()})})}}}]),zaa.directive("clickPastePusher",["$rootScope","$compile",function(a,e){return{restrict:"A",replace:!1,link:function(e,t,n){t.bind("click",function(){a.$broadcast("insertPasteListener",n.clickPastePusher)})}}}]),zaa.directive("insertPasteListener",["$rootScope",function(r){return{restrict:"A",link:function(e,l,t){l.bind("focus",function(){r.lastElement=l[0];r.$on("insertPasteListener",function(e,t){var n=r.lastElement;if(n!=l[0]||!n)return!1;if(r.$$listeners.insertPasteListener=[],document.selection)n.focus(),document.selection.createRange().text=t,n.focus();else if(n.selectionStart||0===n.selectionStart){var a=n.selectionStart,i=n.selectionEnd,o=n.scrollTop;n.value=n.value.substring(0,a)+t+n.value.substring(i,n.value.length),n.focus(),n.selectionStart=a+t.length,n.selectionEnd=a+t.length,n.scrollTop=o}else n.value+=t,n.focus()})})}}}]),zaa.directive("modal",["$timeout",function(e){return{restrict:"E",scope:{isModalHidden:"=",title:"@modalTitle"},replace:!0,transclude:!0,templateUrl:"modal",controller:["$scope","AdminClassService",function(e,n){e.$watch("isModalHidden",function(e,t){e!==t&&(e?n.modalStackRemove():n.modalStackPush())}),e.escModal=function(){e.isModalHidden=!0,n.modalStackRemoveAll()}}],link:function(e,t){e.$on("$destroy",function(){t.remove()}),angular.element(document.body).append(t)}}}]),zaa.directive("crudLoader",["$http","$sce",function(t,a){return{restrict:"E",replace:!0,transclude:!1,scope:{api:"@",alias:"@",modelSelection:"@",modelSetter:"="},controller:["$scope",function(n){n.input={showWindow:!0},n.content=null,n.toggleWindow=function(){if(n.input.showWindow){var e=n.api+"/?inline=1";parseInt(n.modelSelection)&&(e=e+"&modelSelection="+n.modelSetter),t.get(e).then(function(e){n.content=a.trustAsHtml(e.data),n.input.showWindow=!1})}else n.$parent.loadService(),n.input.showWindow=!0},n.$watch("input.showWindow",function(e,t){e!==t&&1==e&&n.$parent.loadService()}),n.setModelValue=function(e,t){n.modelSetter=e,n.toggleWindow()}}],template:function(){return'<div class="crud-loader-tag"><button ng-click="toggleWindow()" type="button" class="btn btn-info btn-icon"><i class="material-icons">playlist_add</i></button><modal is-modal-hidden="input.showWindow" modal-title="{{alias}}"><div class="modal-body" compile-html ng-bind-html="content"></modal></div>'}}}]),zaa.directive("crudRelationLoader",["$http","$sce",function(e,n){return{restrict:"E",replace:!0,transclude:!1,scope:{api:"@api",arrayIndex:"@arrayIndex",modelClass:"@modelClass",id:"@id"},controller:["$scope",function(t){t.content=null,e.get(t.api+"/?inline=1&relation="+t.id+"&arrayIndex="+t.arrayIndex+"&modelClass="+t.modelClass).then(function(e){t.content=n.trustAsHtml(e.data)})}],template:function(){return'<div compile-html ng-bind-html="content"></div>'}}}]),zaa.directive("zaaInjector",["$compile",function(a){return{restrict:"E",replace:!0,transclude:!1,scope:{dir:"=",model:"=",options:"=",label:"@label",grid:"@grid",fieldid:"@fieldid",placeholder:"@placeholder",initvalue:"@initvalue",autocomplete:"@autocomplete"},link:function(e,t){var n=a(angular.element("<"+e.dir+' options="options" initvalue="{{initvalue}}" fieldid="{{fieldid}}" placeholder="{{placeholder}}" autocomplete="{{autocomplete}}" model="model" label="{{label}}" i18n="{{grid}}" />'))(e);t.replaceWith(n)}}}]),zaa.directive("zaaSortRelationArray",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope","$filter",function(i,e){i.searchString,i.sourceData=[],i.dropdownOpen=!1,i.$watch(function(){return i.model},function(e,t){null==e&&(i.model=[])}),i.$watch(function(){return i.options},function(e,t){null!=e&&(i.sourceData=e.sourceData)}),i.getSourceOptions=function(){return i.sourceData},i.getModelItems=function(){return i.model},i.addToModel=function(n){var a=!1;angular.forEach(i.model,function(e,t){e.value==n.value&&(a=!0)}),a||i.model.push({value:n.value,label:n.label})},i.removeFromModel=function(e){i.model.splice(e,1)},i.moveUp=function(e){e=parseInt(e);var t=i.model[e];i.model[e]=i.model[e-1],i.model[e-1]=t},i.moveDown=function(e){e=parseInt(e);var t=i.model[e];i.model[e]=i.model[e+1],i.model[e+1]=t},i.elementInModel=function(n){var a=!1;return angular.forEach(i.model,function(e,t){e.value==n.value&&(a=!0)}),!a}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><div class="list"><div class="list-item" ng-repeat="(key, item) in getModelItems() track by key"><div class="list-buttons"><i ng-show="!$first" ng-click="moveUp(key)" class="material-icons" style="transform: rotate(270deg);">play_arrow</i><i ng-show="!$last" ng-click="moveDown(key)" class="material-icons" style="transform: rotate(90deg);">play_arrow</i></div><span>{{item.label}}</span><div class="float-right"><i ng-click="removeFromModel(key)" class="material-icons">delete</i></div></div><div class="list-item" ng-show="sourceData.length != model.length"><input class="form-control" type="search" ng-model="searchString" ng-focus="dropdownOpen = true" /><ul class="list-group"><li class="list-group-item list-group-item-action" ng-repeat="option in getSourceOptions() | filter:searchString" ng-show="dropdownOpen && elementInModel(option)" ng-click="addToModel(option)"><i class="material-icons">add_circle</i><span>{{ option.label }}</span></li></ul><div class="list-chevron"><i ng-click="dropdownOpen=!dropdownOpen" class="material-icons" ng-show="dropdownOpen">arrow_drop_up</i><i ng-click="dropdownOpen=!dropdownOpen" class="material-icons" ng-show="!dropdownOpen">arrow_drop_down</i></div></div></div></div>'}}}),zaa.directive("zaaLink",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope",function(n){n.unset=function(){n.model=!1,n.data.model=null},n.data={modalState:1,model:null},n.$watch("model",function(e,t){e&&(n.data.model=e)},!0),n.$watch("data.model",function(e,t){e&&(n.model=e)},!0)}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><labelfor="{{id}}">{{label}}</label></div><div class="form-side"><div ng-if="model"><div class="link-selector"><div class="link-selector-actions"><div class="link-selector-btn btn btn-secondary" ng-click="data.modalState=0"><i class="material-icons left">insert_link</i><span>'+i18n.js_link_set_value+'</span></div><span ng-hide="model | isEmpty" class="link-selector-reset" ng-click="unset()"><i class="material-icons">remove_circle</i></span></div><link-object-to-string class="ml-2" link="model"></link-object-to-string></div></div><div ng-if="!model"><div class="link-selector"><div class="link-selector-actions"><div class="link-selector__btn btn btn-secondary" ng-click="data.modalState=0"><i class="material-icons left">insert_link</i><span>'+i18n.js_link_set_value+'</span></div><span style="margin-left:10px;">'+i18n.js_link_not_set+'</span></div></div></div><modal is-modal-hidden="data.modalState" modal-title="{{label}}"><form ng-submit="data.modalState=1"><update-form-redirect data="data.model"></update-form-redirect><button ng-click="data.modalState=1" class="btn btn-icon btn-save" type="submit">'+i18n.js_link_set_value+"</button></form></modal></div></div>"}}}),zaa.directive("zaaSlug",function(){return{restrict:"E",scope:{model:"=",options:"=",listener:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope","$filter",function(n,a){n.$watch(function(){return n.listener},function(e,t){n.model=a("slugify")(e)}),n.$watch(function(){return n.model},function(e,t){e!=t&&(n.model=a("slugify")(e))})}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><input id="{{id}}" insert-paste-listener ng-model="model" type="text" class="form-control" placeholder="{{placeholder}}" /></div></div>'}}}),zaa.directive("zaaColor",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope",function(n){function a(){if(void 0===n.model)return"#000";var e=n.model;if("string"==typeof n.model&&(e=e.substr(1)),3===e.length){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,a){return t+t+n+n+a+a})}return 6===e.length?128<=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3?"#000":"#fff":"#000"}n.textColor=a(),n.$watch(function(){return n.model},function(e,t){n.textColor=a()})}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><div class="colorwheel"><div class="colorwheel-background" style="background-color: {{model}};"><input class="colorwheel-input" type="text" ng-model="model" style="color: {{textColor}}; border-color: {{textColor}};" maxlength="7" /></div><div class="colorwheel-wheel"><div ng-colorwheel="{ size: 150, segments: 120 }" ng-model="model"></div></div></div></div></div>'}}}),zaa.directive("zaaWysiwyg",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},template:function(){return'<ng-wig ng-disabled="false" ng-model="model" buttons="bold, italic, link, list1, list2"></ng-wig>'}}}),zaa.directive("zaaNumber",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid",placeholder:"@placeholder",initvalue:"@initvalue"},link:function(n){n.$watch(function(){return n.model},function(e,t){null==e&&(n.model=parseInt(n.initvalue)),angular.isNumber(n.model)?n.isValid=!0:n.isValid=!1})},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><input id="{{id}}" ng-model="model" type="number" min="0" class="form-control" ng-class="{\'invalid\' : !isValid }" placeholder="{{placeholder}}" /></div></div>'}}}),zaa.directive("zaaDecimal",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid",placeholder:"@placeholder"},controller:["$scope",function(e){null===e.options?e.steps=.01:e.steps=e.options.steps}],link:function(n){n.$watch(function(){return n.model},function(e,t){angular.isNumber(n.model)?n.isValid=!0:n.isValid=!1})},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><input id="{{id}}" ng-model="model" type="number" min="0" step="{{steps}}" class="form-control" ng-class="{\'invalid\' : !isValid }" placeholder="{{placeholder}}" /></div></div>'}}}),zaa.directive("zaaText",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid",placeholder:"@placeholder",autocomplete:"@autocomplete"},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><input id="{{id}}" insert-paste-listener ng-model="model" type="text" class="form-control" autocomplete="{{autocomplete}}" placeholder="{{placeholder}}" /></div></div>'}}}),zaa.directive("zaaReadonly",function(){return{restrict:"E",scope:{model:"=",label:"@label",i18n:"@i18n"},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><span class="text-muted">{{model}}</span></div></div>'}}}),zaa.directive("zaaAsyncValue",function(){return{restrict:"E",scope:{model:"=",api:"@",fields:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope","$timeout","$http",function(n,e,a){e(function(){n.$watch("model",function(e,t){e&&(n.value="",a.get(n.api+"/"+e+"?fields="+n.fields.join()).then(function(e){n.value,angular.forEach(e.data,function(e){e&&(n.value=n.value+e+" ")})}))})}),n.resetValue=function(){n.model=0,n.value=null}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><span ng-bind="value"></span><button type="button" class="btn btn-icon btn-cancel" ng-click="resetValue()" ng-show="model"></button></div></div>'}}}),zaa.directive("zaaTextarea",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid",placeholder:"@placeholder"},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><textarea id="{{id}}" insert-paste-listener ng-model="model" type="text" class="form-control" auto-grow placeholder="{{placeholder}}"></textarea></div></div>'}}}),zaa.directive("zaaPassword",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid",autocomplete:"@autocomplete"},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><input id="{{id}}" ng-model="model" type="password" class="form-control" autocomplete="{{autocomplete}}" placeholder="{{placeholder}}" /></div></div>'}}}),zaa.directive("zaaRadio",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid",initvalue:"@initvalue"},controller:["$scope",function(t){t.setModelValue=function(e){t.model=e}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><div ng-repeat="(key, item) in options" class="form-check"><input value="{{item.value}}" type="radio" ng-click="setModelValue(item.value)" ng-checked="item.value == model" name="{{id}}_{{key}}" class="form-check-input" id="{{id}}_{{key}}"><label class="form-check-label" for="{{id}}_{{key}}">{{item.label}}</label></div></div></div>'}}}),zaa.directive("zaaSelect",function(){return{restrict:"E",scope:{model:"=",options:"=",optionsvalue:"@optionsvalue",optionslabel:"@optionslabel",label:"@label",i18n:"@i18n",id:"@fieldid",initvalue:"@initvalue"},controller:["$scope","$timeout","$rootScope",function(a,e,t){a.isOpen=0,null==a.optionsvalue&&(a.optionsvalue="value"),null==a.optionslabel&&(a.optionslabel="label"),angular.isNumber(a.model)&&(a.model=typeCastValue(a.model)),a.$on("closeAllSelects",function(){a.isOpen&&a.closeSelect()}),e(function(){a.$watch(function(){return a.model},function(e,t){null!=e&&null!=e&&""!=e||(angular.isNumber(a.initvalue)&&(a.initvalue=typeCastValue(a.initvalue)),a.valueExistsInOptions(e)||(a.model=a.initvalue))})}),a.valueExistsInOptions=function(t){var n=!1;return angular.forEach(a.options,function(e){t==e.value&&(n=!0)}),n},a.toggleIsOpen=function(){a.isOpen||t.$broadcast("closeAllSelects"),a.isOpen=!a.isOpen},a.closeSelect=function(){a.isOpen=0},a.setModelValue=function(e){a.model=e[a.optionsvalue],a.closeSelect()},a.getSelectedLabel=function(){var t=i18n.ngrest_select_no_selection;return angular.forEach(a.options,function(e){a.model==e[a.optionsvalue]&&(t=e[a.optionslabel])}),t},a.hasSelectedValue=function(){var e=a.model;return!(!a.valueExistsInOptions(e)||e==a.initvalue)}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><div class="zaaselect" ng-class="{\'open\':isOpen, \'selected\':hasSelectedValue()}"><select class="zaaselect-select" ng-model="model"><option ng-repeat="opt in options" ng-value="opt[optionsvalue]">{{opt[optionslabel]}}</option></select><div class="zaaselect-selected"><span class="zaaselect-selected-text" ng-click="toggleIsOpen()">{{getSelectedLabel()}}</span><i class="material-icons zaaselect-clear-icon" ng-click="model=initvalue">clear</i><i class="material-icons zaaselect-dropdown-icon" ng-click="toggleIsOpen()">keyboard_arrow_down</i></div><div class="zaaselect-dropdown"><div class="zaaselect-search"><input class="zaaselect-search-input" type="search" focus-me="isOpen" ng-model="searchQuery" /></div><div class="zaaselect-overflow"><div class="zaaselect-item" ng-repeat="opt in options | filter:searchQuery" ng-click="setModelValue(opt)"><span ng-class="{\'zaaselect-active\': opt[optionsvalue] == model}">{{opt[optionslabel]}}</span></div></div></div></div></div></div>'}}}),zaa.directive("zaaCheckbox",function(){return{restrict:"E",scope:{model:"=",options:"=",i18n:"@i18n",id:"@fieldid",label:"@label",initvalue:"@initvalue"},controller:["$scope","$timeout",function(e,t){null===e.options||void 0===e.options?(e.valueTrue=1,e.valueFalse=0):(e.valueTrue=e.options["true-value"],e.valueFalse=e.options["false-value"]),e.init=function(){null==e.model&&null==e.model&&(e.model=typeCastValue(e.initvalue))},t(function(){e.init()})}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><div class="form-check"><input id="{{id}}" ng-true-value="{{valueTrue}}" ng-false-value="{{valueFalse}}" ng-model="model" type="checkbox" class="form-check-input-standalone" /><label for="{{id}}"></label></div></div></div>'}}}),zaa.directive("zaaCheckboxArray",function(){return{restrict:"E",scope:{model:"=",options:"=",i18n:"@i18n",id:"@fieldid",label:"@label"},controller:["$scope","$filter",function(n,a){null==n.model&&(n.model=[]),n.searchString="",n.$watch("options",function(e,t){null!=e&&e.hasOwnProperty("items")&&(n.optionitems=a("orderBy")(e.items,"label"))}),n.filtering=function(){n.optionitems=a("filter")(n.options.items,n.searchString)},n.toggleSelection=function(e){for(var t in null==n.model&&(n.model=[]),n.model)if(n.model[t].value==e.value)return void n.model.splice(t,1);n.model.push({value:e.value})},n.isChecked=function(e){for(var t in n.model)if(n.model[t].value==e.value)return!0;return!1}}],link:function(e){e.random=Math.random().toString(36).substring(7)},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label for="{{id}}">{{label}}</label></div><div class="form-side"><div class="input-group mb-3"><div class="input-group-addon"><i class="material-icons">search</i></div><input class="form-control" type="text" ng-change="filtering()" ng-model="searchString" placeholder="Enter search term..."><span class="zaa-checkbox-array-counter badge badge-secondary">{{optionitems.length}} '+i18n.js_dir_till+' {{options.items.length}}</span></div><div class="form-check" ng-repeat="(k, item) in optionitems track by k"><input type="checkbox" class="form-check-input" ng-checked="isChecked(item)" id="{{random}}_{{k}}" ng-click="toggleSelection(item)" /><label for="{{random}}_{{k}}">{{item.label}}</label></div></div></div>'}}}),zaa.directive("zaaDatetime",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",id:"@fieldid",i18n:"@i18n",resetable:"@resetable"},controller:["$scope","$filter",function(a,i){a.isNumeric=function(e){return!isNaN(e)},a.$watch(function(){return a.model},function(e,t){if(null!=e&&null!=e){var n=new Date(1e3*e);a.pickerPreselect=n,a.date=i("date")(n,"dd.MM.yyyy"),a.hour=i("date")(n,"H"),a.min=i("date")(n,"m")}else a.date=null,a.model=null}),a.refactor=function(e){if(a.isNumeric(a.hour)&&""!=a.hour||(a.hour="0"),a.isNumeric(a.min)&&""!=a.min||(a.min="0"),"Invalid Date"==e||""==e||"NaN"==e)a.date=null,a.model=null;else{var t=e.split(".");if(3==t.length&&4==t[2].length){23<parseInt(a.hour)&&(a.hour=23),59<parseInt(a.min)&&(a.min=59);var n=t[1]+"/"+t[0]+"/"+t[2]+" "+a.hour+":"+a.min;a.model=Date.parse(n)/1e3,a.datePickerToggler=!1}}},a.$watch(function(){return a.date},function(e,t){e!=t&&null!=e&&null!=e&&a.refactor(e)}),a.autoRefactor=function(){a.refactor(a.date)},a.datePickerToggler=!1,a.toggleDatePicker=function(){a.datePickerToggler=!a.datePickerToggler},a.openDatePicker=function(){a.datePickerToggler=!0},a.closeDatePicker=function(){a.datePickerToggler=!1},a.hour="0",a.min="0",a.reset=function(){a.model=null},a.getIsResetable=function(){return!a.resetable||parseInt(a.resetable)}}],template:function(){return'<div class="form-group form-side-by-side zaa-datetime" ng-class="{\'input--hide-label\': i18n, \'input--with-time\': model!=null && date!=null}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side form-inline datepicker-wrapper"><datepicker date-set="{{pickerPreselect.toString()}}" date-week-start-day="1" datepicker-toggle="false" datepicker-show="{{datePickerToggler}}" date-format="dd.MM.yyyy"><input class="form-control datepicker-date-input" ng-model="date" type="text" ng-focus="openDatePicker()" /><div class="input-group-addon" ng-click="toggleDatePicker()"><i class="material-icons" ng-hide="datePickerToggler">date_range</i><i class="material-icons" ng-show="datePickerToggler">close</i></div></datepicker><div ng-show="model!=null && date!=null" class="hour-selection"><div class="input-group"><div class="input-group-addon"><i class="material-icons">access_time</i></div><input class="form-control zaa-datetime-hour-input" type="text" ng-model="hour" ng-change="autoRefactor()" /></div><div class="input-group"><div class="input-group-addon zaa-datetime-time-colon">:</div><input class="form-control zaa-datetime-minute-input" type="text" ng-model="min" ng-change="autoRefactor()" /></div></div><div ng-show="model && getIsResetable()"><button type="button" ng-click="reset()" class="ml-2 btn btn-icon btn-cancel"></nutton></div></div></div>'}}}),zaa.directive("zaaDate",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",id:"@fieldid",i18n:"@i18n",resetable:"@resetable"},controller:["$scope","$filter",function(a,i){a.$watch(function(){return a.model},function(e,t){if(null!=e&&null!=e){var n=new Date(1e3*e);a.pickerPreselect=n,a.date=i("date")(n,"dd.MM.yyyy")}else a.date=null,a.model=null}),a.refactor=function(e){if("Invalid Date"==e||""==e)a.date=null,a.model=null;else{var t=e.split(".");if(3==t.length&&4==t[2].length){var n=t[1]+"/"+t[0]+"/"+t[2];a.model=Date.parse(n)/1e3,a.datePickerToggler=!1}}},a.$watch(function(){return a.date},function(e,t){e!=t&&null!=e&&null!=e&&a.refactor(e)}),a.autoRefactor=function(){a.refactor(a.date)},a.datePickerToggler=!1,a.toggleDatePicker=function(){a.datePickerToggler=!a.datePickerToggler},a.openDatePicker=function(){a.datePickerToggler=!0},a.closeDatePicker=function(){a.datePickerToggler=!1},a.reset=function(){a.model=null},a.getIsResetable=function(){return!a.resetable||parseInt(a.resetable)}}],template:function(){return'<div class="form-group form-side-by-side zaa-date" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side datepicker-wrapper"><datepicker date-set="{{pickerPreselect.toString()}}" date-week-start-day="1" datepicker-toggle="false" datepicker-show="{{datePickerToggler}}" date-format="dd.MM.yyyy"><input class="form-control datepicker-date-input" ng-model="date" type="text" ng-focus="openDatePicker()" /><div class="input-group-addon" ng-click="toggleDatePicker()"><i class="material-icons" ng-hide="datePickerToggler">date_range</i><i class="material-icons" ng-show="datePickerToggler">close</i></div></datepicker><div ng-show="model && getIsResetable()"><button type="button" ng-click="reset()" class="ml-2 btn btn-icon btn-cancel"></nutton></div></div></div>'}}}),zaa.directive("zaaTable",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope",function(a){null==a.model&&(a.model=[{0:""}]),a.addColumn=function(){var e=0;for(var t in a.model[0])e++;for(var n in a.model)a.model[n][e]=""},a.addRow=function(){var e=a.model[0],t={};for(var n in e)t[n]="";a.model.push(t)},a.removeColumn=function(e){for(var t in a.model){var n=a.model[t];n instanceof Array?n.splice(e,1):delete n[e]}},a.moveLeft=function(e){for(var t in e=parseInt(e),a.model){var n=a.model[t][e];a.model[t][e]=a.model[t][e-1],a.model[t][e-1]=n}},a.moveRight=function(e){for(var t in e=parseInt(e),a.model){var n=a.model[t][e];a.model[t][e]=a.model[t][e+1],a.model[t][e+1]=n}},a.moveUp=function(e){e=parseInt(e);var t=a.model[e];a.model[e]=a.model[e-1],a.model[e-1]=t},a.moveDown=function(e){e=parseInt(e);var t=a.model[e];a.model[e]=a.model[e+1],a.model[e+1]=t},a.removeRow=function(e){a.model.splice(e,1)},a.showRightButton=function(e){return parseInt(e)<Object.keys(a.model[0]).length-1},a.showDownButton=function(e){return parseInt(e)<Object.keys(a.model).length-1}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label ng-if="label">{{label}}</label><label ng-if="!label">Table</label></div><div class="form-side"><div class="zaa-table-wrapper"><table class="zaa-table table table-bordered"><tbody><tr><th scope="col" width="35px"></th><th scope="col" data-ng-repeat="(hk, hr) in model[0] track by hk" class="zaa-table-buttons"><div class="btn-group" role="group"><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveLeft(hk)" ng-if="hk > 0"><i class="material-icons">keyboard_arrow_left</i></button><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveRight(hk)" ng-if="showRightButton(hk)"><i class="material-icons">keyboard_arrow_right</i></button><button type="button" class="btn btn-sm btn-outline-danger" ng-click="removeColumn(hk)"><i class="material-icons">remove</i></button></div></th></tr><tr data-ng-repeat="(key, row) in model track by key"><td width="35px" scope="row" class="zaa-table-buttons"><div class="btn-group-vertical" role="group"><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveUp(key)" ng-if="key > 0"><i class="material-icons">keyboard_arrow_up</i></button><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveDown(key)" ng-if="showDownButton(key)"><i class="material-icons">keyboard_arrow_down</i></button><button type="button" class="btn btn-sm btn-outline-danger" ng-click="removeRow(key)"><i class="material-icons">remove</i></button></div></td><td data-ng-repeat="(field,value) in row track by field"><textarea ng-model="model[key][field]" class="zaa-table__textarea"></textarea></td></tr></tbody></table><button ng-click="addRow()" type="button" class="zaa-table-add-row btn btn-sm btn-success"><i class="material-icons">add</i></button><button ng-click="addColumn()" type="button" class="zaa-table-add-column btn btn-sm btn-success"><i class="material-icons">add</i></button></div></div></div>'}}}),zaa.directive("zaaFileUpload",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><storage-file-upload ng-model="model"></storage-file-upload></div></div>'}}}),zaa.directive("zaaImageUpload",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><storage-image-upload options="options" ng-model="model"></storage-image-upload></div></div>'}}}),zaa.directive("zaaImageArrayUpload",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},link:function(e,n,t){e.$watch("model",function(e,t){1<=e.length?$(n).removeClass("is-empty").addClass("is-not-empty"):$(n).removeClass("is-not-empty").addClass("is-empty")},!0)},controller:["$scope",function(n){null==n.model&&(n.model=[]),n.add=function(){null!=n.model&&""!=n.model&&null!=n.model||(n.model=[]),n.model.push({imageId:0,caption:""})},n.remove=function(e){n.model.splice(e,1)},n.moveUp=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e-1],n.model[e-1]=t},n.moveDown=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e+1],n.model[e+1]=t},n.showDownButton=function(e){return parseInt(e)<Object.keys(n.model).length-1}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><div class="list zaa-file-array-upload"><p class="alert alert-info" ng-hide="model.length > 0">'+i18n.js_dir_no_selection+'</p><div ng-repeat="(key,image) in model track by key" class="list-item"><div class="list-section"><div class="list-left"><storage-image-upload ng-model="image.imageId" options="options"></storage-image-upload></div><div class="list-right"><div class="form-group"><label for="{{image.id}}">'+i18n.js_dir_image_description+'</label><textarea ng-model="image.caption" id="{{image.id}}" class="zaa-file-array-upload-description form-control" auto-grow></textarea></div></div></div><div class="list-buttons"><div class="btn-group" role="group"><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveUp(key)" ng-if="key > 0"><i class="material-icons">keyboard_arrow_up</i></button><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveDown(key)" ng-if="showDownButton(key)"><i class="material-icons">keyboard_arrow_down</i></button><button type="button" class="btn btn-sm btn-outline-danger" ng-click="remove(key)"><i class="material-icons">remove</i></button></div></div></div><button ng-click="add()" type="button" class="btn btn-sm btn-success list-add-button"><i class="material-icons">add</i></button></div></div></div>'}}}),zaa.directive("zaaFileArrayUpload",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope","$element","$timeout",function(n,e,t){null==n.model&&(n.model=[]),n.add=function(){null!=n.model&&""!=n.model&&null!=n.model||(n.model=[]),n.model.push({fileId:0,caption:""})},n.remove=function(e){n.model.splice(e,1)},n.moveUp=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e-1],n.model[e-1]=t},n.moveDown=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e+1],n.model[e+1]=t},n.showDownButton=function(e){return parseInt(e)<Object.keys(n.model).length-1}}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><div class="list zaa-file-array-upload"><p class="alert alert-info" ng-hide="model.length > 0">'+i18n.js_dir_no_selection+'</p><div ng-repeat="(key,file) in model track by key" class="list-item"><div class="list-section" ng-if="file.hiddenStorageUploadSource"><a ng-href="{{file.hiddenStorageUploadSource}}" target="_blank" class="btn btn-primary">{{file.hiddenStorageUploadName}}</a></div><div class="list-section" ng-if="!file.hiddenStorageUploadSource"><div class="list-left"><storage-file-upload ng-model="file.fileId"></storage-file-upload></div><div class="list-right"><div class="form-group"><label for="{{file.id}}">'+i18n.js_dir_image_description+'</label><textarea ng-model="file.caption" id="{{file.id}}" class="zaa-file-array-upload-description form-control" auto-grow></textarea></div></div></div><div class="list-buttons"  ng-if="!file.hiddenStorageUploadSource"><div class="btn-group" role="group"><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveUp(key)" ng-if="key > 0"><i class="material-icons">keyboard_arrow_up</i></button><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveDown(key)" ng-if="showDownButton(key)"><i class="material-icons">keyboard_arrow_down</i></button><button type="button" class="btn btn-sm btn-outline-danger" ng-click="remove(key)"><i class="material-icons">remove</i></button></div></div></div></div><button ng-click="add()" type="button" class="btn btn-sm btn-success list-add-button"><i class="material-icons">add</i></button></div></div>'}}}),zaa.directive("zaaMultipleInputs",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope","$timeout",function(n,e){n.init=function(){null==n.model||null==n.model?n.model=[]:angular.forEach(n.model,function(e,t){0==Object.keys(e).length&&(n.model[t]={})})},n.add=function(){null!=n.model&&""!=n.model&&null!=n.model||(n.model=[]),n.model.push({})},n.remove=function(e){n.model.splice(e,1)},n.moveUp=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e-1],n.model[e-1]=t},n.moveDown=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e+1],n.model[e+1]=t},n.showDownButton=function(e){return parseInt(e)<Object.keys(n.model).length-1},e(function(){n.init()})}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><div class="list zaa-multiple-inputs"><p class="alert alert-info" ng-hide="model.length > 0">'+i18n.js_dir_no_selection+'</p><div ng-repeat="(msortKey,row) in model track by msortKey" class="list-item" ng-init="ensureRow(row)"><div ng-repeat="(mutliOptKey,opt) in options track by mutliOptKey"><zaa-injector dir="opt.type" options="opt.options" fieldid="id-{{msortKey}}-{{mutliOptKey}}" initvalue="{{opt.initvalue}}" label="{{opt.label}}" model="row[opt.var]"></zaa-injector></div><div class="list-buttons"><div class="btn-group" role="group"><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveUp(msortKey)" ng-if="msortKey > 0"><i class="material-icons">keyboard_arrow_up</i></button><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveDown(msortKey)" ng-if="showDownButton(msortKey)"><i class="material-icons">keyboard_arrow_down</i></button><button type="button" class="btn btn-sm btn-outline-danger" ng-click="remove(msortKey)"><i class="material-icons">remove</i></button></div></div></div><button ng-click="add()" type="button" class="btn btn-sm btn-success list-add-button"><i class="material-icons">add</i></button></div></div></div>'}}}),zaa.directive("zaaListArray",function(){return{restrict:"E",scope:{model:"=",options:"=",label:"@label",i18n:"@i18n",id:"@fieldid"},controller:["$scope","$element","$timeout",function(n,t,e){n.init=function(){null!=n.model&&null!=n.model||(n.model=[])},n.add=function(){null!=n.model&&""!=n.model&&null!=n.model||(n.model=[]),n.model.push({value:""}),n.setFocus()},n.remove=function(e){n.model.splice(e,1)},n.refactor=function(e,t){e!==n.model.length-1&&""==t.value&&n.remove(e)},n.setFocus=function(){e(function(){var e=t.children(".list").children(".list__item:last-of-type").children(".list__left").children("input");1==e.length&&e[0].focus()},50)},n.moveUp=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e-1],n.model[e-1]=t},n.moveDown=function(e){e=parseInt(e);var t=n.model[e];n.model[e]=n.model[e+1],n.model[e+1]=t},n.showDownButton=function(e){return parseInt(e)<Object.keys(n.model).length-1},n.init()}],template:function(){return'<div class="form-group form-side-by-side" ng-class="{\'input--hide-label\': i18n}"><div class="form-side form-side-label"><label>{{label}}</label></div><div class="form-side"><div class="list zaa-file-array-upload"><p class="alert alert-info" ng-hide="model.length > 0">'+i18n.js_dir_no_selection+'</p><div ng-repeat="(key,row) in model track by key" class="list-item"><input class="form-control list-input" type="text" ng-model="row.value" /><div class="list-buttons"><div class="btn-group" role="group"><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveUp(key)" ng-if="key > 0"><i class="material-icons">keyboard_arrow_up</i></button><button type="button" class="btn btn-sm btn-outline-info" ng-click="moveDown(key)" ng-if="showDownButton(key)"><i class="material-icons">keyboard_arrow_down</i></button><button type="button" class="btn btn-sm btn-outline-danger" ng-click="remove(key)"><i class="material-icons">remove</i></button></div></div></div><button ng-click="add()" type="button" class="btn btn-sm btn-success list-add-button"><i class="material-icons">add</i></button></div></div></div>'}}}),zaa.directive("storageFileUpload",function(){return{restrict:"E",scope:{ngModel:"="},controller:["$scope","$filter","ServiceFilesData",function(a,i,e){a.filesData=e.data,a.$on("service:FilesData",function(e,t){a.filesData=t}),a.modal={state:1},a.modalContainer=!1,a.fileinfo=null,a.select=function(e){a.toggleModal(),a.ngModel=e},a.reset=function(){a.ngModel=0,a.fileinfo=null},a.toggleModal=function(){a.modalContainer=!a.modalContainer,a.modal.state=!a.modal.state},a.$watch(function(){return a.ngModel},function(e,t){if(0!=e&&null!=e&&void 0!==e){var n=i("filter")(a.filesData,{id:parseInt(e)},!0);n&&1==n.length&&(a.fileinfo=n[0])}0==e&&a.reset()})}],templateUrl:"storageFileUpload"}}),zaa.directive("storageFileDisplay",function(){return{restrict:"E",scope:{fileId:"@fileId"},controller:["$scope","$filter","ServiceFilesData",function(a,i,e){a.filesData=e.data,a.$on("service:FilesData",function(e,t){a.filesData=t}),a.fileinfo=null,a.$watch("fileId",function(e,t){if(0!=e&&null!=e&&void 0!==e){var n=i("filter")(a.filesData,{id:parseInt(e)},!0);n&&1==n.length&&(a.fileinfo=n[0])}})}],template:function(){return'<div ng-show="fileinfo!==null">{{ fileinfo.name }}</div>'}}}),zaa.directive("storageImageThumbnailDisplay",function(){return{restrict:"E",scope:{imageId:"@imageId"},controller:["$scope","$filter","ServiceImagesData","ServiceFilesData",function(i,o,e,t){i.filesData=t.data,i.$on("service:FilesData",function(e,t){i.filesData=t}),i.imagesData=e.data,i.$on("service:ImagesData",function(e,t){i.imagesData=t}),i.$watch(function(){return i.imageId},function(e,t){if(0!=e&&void 0!==e){var n=o("findidfilter")(i.imagesData,e,!0),a=o("findidfilter")(i.filesData,n.fileId,!0);a&&a.thumbnail&&(i.imageSrc=a.thumbnail.source)}}),i.imageSrc=null}],template:function(){return'<div ng-show="imageSrc!==false"><img ng-src="{{imageSrc}}" /></div>'}}}),zaa.directive("storageImageUpload",function(){return{restrict:"E",scope:{ngModel:"=",options:"="},controller:["$scope","$http","$filter","ServiceFiltersData","ServiceImagesData","AdminToastService",function(a,n,i,e,t,o){a.imagesData=t.data,a.$on("service:ImagesData",function(e,t){a.imagesData=t}),a.imagesDataReload=function(){return t.load(!0)},a.filtersData=e.data,a.$on("service:FiltersData",function(e,t){a.filtersData=t}),a.noFilters=function(){if(a.options)return a.options.no_filter},a.thumbnailfilter=null,a.imageLoading=!1,a.fileId=0,a.filterId=0,a.imageinfo=null,a.imageNotFoundError=!1,a.filterApply=function(){var e=i("filter")(a.imagesData,{fileId:a.fileId,filterId:a.filterId},!0);if(e&&0==e.length)a.imageLoading=!0,n.post("admin/api-admin-storage/image-upload",$.param({fileId:a.fileId,filterId:a.filterId}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){t.data.error||a.imagesDataReload().then(function(e){a.ngModel=t.data.id,o.success(i18n.js_dir_image_upload_ok),a.imageLoading=!1})},function(e){o.error(i18n.js_dir_image_filter_error),a.imageLoading=!1});else{var t=e[0];a.ngModel=t.id,a.imageinfo=t}},a.$watch(function(){return a.filterId},function(e,t){null!=e&&void 0!==e&&0!==a.fileId&&e!==t&&e!=t&&a.filterApply()}),a.$watch(function(){return a.fileId},function(e,t){void 0!==e&&null!=e&&e!=t&&(0==e?(a.filterId=0,a.imageinfo=null,a.ngModel=0):a.filterApply())}),a.$watch(function(){return a.ngModel},function(e,t){if(0!=e&&null!=e&&void 0!==e){var n=i("findidfilter")(a.imagesData,e,!0);n?(a.imageinfo=n,a.filterId=n.filterId,a.fileId=n.fileId):a.imageNotFoundError=!0}null!=e&&0!=e||(a.fileId=0,a.filterId=0,a.imageinfo=null,a.thumb=!1)}),a.thumb=!1,a.getThumbnailFilter=function(){return null===a.thumbnailfilter&&"medium-thumbnail"in a.filtersData&&(a.thumbnailfilter=a.filtersData["medium-thumbnail"]),a.thumbnailfilter},a.$watch("imageinfo",function(e,t){if(0!=e&&null!=e&&void 0!==e)if(0!=e.filterId)a.thumb=e;else{var n=i("findthumbnail")(a.imagesData,e.fileId,a.getThumbnailFilter().id);a.thumb=n||e}})}],templateUrl:"storageImageUpload"}}),zaa.directive("storageFileManager",function(){return{restrict:"E",transclude:!1,scope:{allowSelection:"@selection",onlyImages:"@onlyImages"},controller:["$scope","$http","$filter","$timeout","Upload","ServiceFoldersData","ServiceFilesData","LuyaLoading","AdminToastService","ServiceFoldersDirecotryId",function(a,i,n,o,l,e,t,r,s,d){a.foldersData=e.data,a.$on("service:FoldersData",function(e,t){a.foldersData=t}),a.foldersDataReload=function(){return e.load(!0)},a.filesData=t.data,a.$on("service:FilesData",function(e,t){a.filesData=t}),a.filesDataReload=function(){return t.load(!0)},a.currentFolderId=d.folderId,a.$on("FoldersDirectoryId",function(e,t){a.currentFolderId=t}),a.foldersDirecotryIdReload=function(){return d.load(!0)},a.folderCountMessage=function(e){return i18nParam("js_filemanager_count_files_overlay",{count:e.filesCount})},a.errorMsg=null,a.replaceFile=function(e,t){(a.replaceFiled=e)&&(r.start(),l.upload({url:"admin/api-admin-storage/file-replace",data:{file:e,fileId:a.fileDetail.id}}).then(function(e){r.stop(),200==e.status&&a.filesDataReload().then(function(){var e=n("findidfilter")(a.filesData,a.fileDetail.id,!0),t=(new Date).toString();e.isImage&&(e.thumbnail.source=e.thumbnail.source+"?cb="+t,e.thumbnailMedium.source=e.thumbnailMedium.source+"?cb="+t),a.fileDetail=e,s.success("the file has been replaced successfull.")})},function(){r.stop()}))},a.$watch("uploadingfiles",function(e){if(null!=e){a.uploadResults=0,r.start(i18n.js_dir_upload_wait);for(var t=0;t<e.length;t++)a.errorMsg=null,n=e[t],a.uploadUsingUpload(n)}var n}),a.$watch("uploadResults",function(e,t){null!=a.uploadingfiles&&e==a.uploadingfiles.length&&null==a.errorMsg&&a.filesDataReload().then(function(){s.success(i18n.js_dir_manager_upload_image_ok),r.stop()})}),a.pasteUpload=function(e){for(var t=0;t<e.originalEvent.clipboardData.items.length;t++){var n=e.originalEvent.clipboardData.items[t];"file"==n.kind&&(r.start(i18n.js_dir_upload_wait),l.upload({url:"admin/api-admin-storage/files-upload",fields:{folderId:a.currentFolderId},file:n.getAsFile()}).then(function(e){e.data.upload?a.filesDataReload().then(function(){s.success(i18n.js_dir_manager_upload_image_ok),r.stop()}):(s.error(e.data.message),r.stop())}))}},a.uploadUsingUpload=function(t){t.upload=l.upload({url:"admin/api-admin-storage/files-upload",fields:{folderId:a.currentFolderId},file:t}),t.upload.then(function(e){o(function(){a.uploadResults++,t.processed=!0,t.result=e.data,t.result.upload||(s.error(t.result.message),r.stop(),a.errorMsg=!0)})},function(e){0<e.status&&(a.errorMsg=!0)}),t.upload.progress(function(e){t.processed=!1,t.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},a.selectedFiles=[],a.toggleSelectionAll=function(){n("filemanagerfilesfilter")(a.filesData,a.currentFolderId,a.onlyImages).forEach(function(e,t){a.toggleSelection(e)})},a.toggleSelection=function(e){if("true"!=a.allowSelection){var t=a.selectedFiles.indexOf(e.id);-1<t?a.selectedFiles.splice(t,1):a.selectedFiles.push(e.id)}else a.$parent.select(e.id)},a.inSelection=function(e){return-1!=a.selectedFiles.indexOf(e.id)},a.showFolderForm=!1,a.createNewFolder=function(e){e&&i.post("admin/api-admin-storage/folder-create",$.param({folderName:e,parentFolderId:a.currentFolderId}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(){a.foldersDataReload().then(function(){a.folderFormToggler(),a.newFolderName=null})})},a.folderFormToggler=function(){a.showFolderForm=!a.showFolderForm},a.searchQuery="",a.sortField="name",a.changeSortField=function(e){a.sortField=e},a.changeCurrentFolderId=function(e,t){a.currentFolderId=e,!0!==t&&(d.folderId=e,i.post("admin/api-admin-common/save-filemanager-folder-state",{folderId:e},{ignoreLoadingBar:!0}))},a.toggleFolderItem=function(e){null==e.toggle_open?e.toggle_open=1:e.toggle_open=!e.toggle_open,i.post("admin/api-admin-common/filemanager-foldertree-history",{data:e},{ignoreLoadingBar:!0})},a.folderUpdateForm=!1,a.folderDeleteForm=!1,a.folderDeleteConfirmForm=!1,a.updateFolder=function(e){i.post("admin/api-admin-storage/folder-update?folderId="+e.id,$.param({name:e.name}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})},a.deleteFolder=function(n){i.post("admin/api-admin-storage/is-folder-empty?folderId="+n.id,$.param({name:n.name}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1==e.data?i.post("admin/api-admin-storage/folder-delete?folderId="+n.id,$.param({name:n.name}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){a.foldersDataReload().then(function(){a.filesDataReload().then(function(){a.currentFolderId=0})})}):s.confirm(i18nParam("layout_filemanager_remove_dir_not_empty",{folderName:n.name,count:n.filesCount}),i18n.js_dir_manager_rm_folder_confirm_title,["$timeout","$toast",function(e,t){i.post("admin/api-admin-storage/folder-delete?folderId="+n.id,$.param({name:n.name}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(){a.foldersDataReload().then(function(){a.filesDataReload().then(function(){a.currentFolderId=0,t.close()})})})}])})},a.fileDetail=!1,a.showFoldersToMove=!1,a.largeImagePreviewState=!0,a.fileDetailFull=!1,a.nameEditMode=!1,a.openFileDetail=function(e){a.fileDetail.id==e.id?a.closeFileDetail():(i.get("admin/api-admin-storage/file-info?id="+e.id).then(function(e){a.fileDetailFull=e.data}),a.fileDetail=e)},a.updateFileData=function(){i.put("admin/api-admin-storage/file-update?id="+a.fileDetailFull.id,a.fileDetailFull).then(function(e){n("findidfilter")(a.filesData,a.fileDetail.id,!0).name=e.data.name_original,a.nameEditMode=!1})},a.closeFileDetail=function(){a.fileDetail=!1,a.fileDetailFull=!1,a.nameEditMode=!1},a.removeFile=function(e){a.selectedFiles=[],a.toggleSelection(e),a.removeFiles()},a.moveFilesTo=function(e){i.post("admin/api-admin-storage/filemanager-move-files",$.param({fileIds:a.selectedFiles,toFolderId:e}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){a.filesDataReload().then(function(){a.selectedFiles=[],a.showFoldersToMove=!1})})},a.removeFiles=function(){s.confirm(i18n.js_dir_manager_rm_file_confirm,i18n.js_dir_manager_rm_file_confirm_title,["$timeout","$toast",function(e,t){i.post("admin/api-admin-storage/filemanager-remove-files",$.param({ids:a.selectedFiles}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){a.filesDataReload().then(function(){t.close(),s.success(i18n.js_dir_manager_rm_file_ok),a.selectedFiles=[],a.closeFileDetail()})})}])},a.storeFileCaption=function(e){i.post("admin/api-admin-storage/filemanager-update-caption",$.param({id:e.id,captionsText:e.captionArray}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){s.success("Captions has been updated")})},a.selectedFileFromParent=null,a.init=function(){a.$parent.fileinfo&&(a.selectedFileFromParent=a.$parent.fileinfo,a.changeCurrentFolderId(a.selectedFileFromParent.folderId,!0))},a.init()}],templateUrl:"storageFileManager"}}),zaa.directive("hasEnoughSpace",["$window","$timeout",function(o,l){return{restrict:"A",scope:{loadingCondition:"=",isFlexBox:"="},link:function(n,a,e){n.elementWidth=0;var t=function(){var e=a.clone().insertAfter(a);e.css({position:"fixed",top:0,left:0,visibility:"hidden"}),"none"===e.css("display")&&e.css("display",n.isFlexBox?"flex":"block");var t=e.outerWidth();return e.remove(),t};function i(){l(function(){n.elementOriginalWidth||(n.elementOriginalWidth=t()),a.hasClass("not-enough-space")&&(a.removeClass("not-enough-space"),a.addClass("has-enough-space")),a.parent().outerWidth()<n.elementOriginalWidth?a.removeClass("has-enough-space").addClass("not-enough-space"):a.removeClass("not-enough-space").addClass("has-enough-space")})}angular.element(o).on("resize",function(){i()}),n.$watch("loadingCondition",function(e){1==e&&i()})}}}]),zaa.directive("activeClass",function(){return{restrict:"A",scope:{activeClass:"@"},link:function(e,t){t.on("mouseenter",function(){t.addClass(e.activeClass)}),t.on("mouseleave",function(){t.removeClass(e.activeClass)}),t.on("click",function(){t.toggleClass(e.activeClass)})}}}),zaa.controller("DefaultDashboardObjectController",["$scope","$http","$sce",function(t,n,e){t.data,t.loadData=function(e){n.get(e).then(function(e){t.data=e.data})}}]),zaa.controller("CrudController",["$scope","$filter","$http","$sce","$state","$timeout","$injector","$q","AdminLangService","LuyaLoading","AdminToastService","CrudTabService",function(r,a,s,i,o,l,e,n,t,d,c,u){r.toast=c,r.AdminLangService=t,r.tabService=u,r.crudSwitchType=0,r.switchToTab=function(e){angular.forEach(r.tabService.tabs,function(e){e.active=!1}),e.active=!0,r.switchTo(4)},r.addAndswitchToTab=function(e,t,n,a,i){r.tabService.addTab(e,t,n,a,i),r.switchTo(4)},r.closeTab=function(e,t){r.tabService.remove(t,r)},r.switchTo=function(e,t){r.config.relationCall?r.crudSwitchType=e:(t&&r.resetData(),0==e&&s.get(r.config.apiEndpoint+"/unlock"),0!=e&&1!=e||r.config.inline||o.go("default.route"),4===(r.crudSwitchType=e)||r.config.inline||angular.forEach(r.tabService.tabs,function(e){e.active=!1}))},r.closeUpdate=function(){r.switchTo(0,!0)},r.closeCreate=function(){r.switchTo(0,!0)},r.activeWindowModal=!0,r.openActiveWindow=function(){r.activeWindowModal=!1},r.closeActiveWindow=function(){r.activeWindowModal=!0},r.changeGroupByField=function(){0==r.config.groupByField?r.config.groupBy=0:r.config.groupBy=1},r.exportLoading=!1,r.exportResponse=!1,r.exportDownloadButton=!1,r.exportData=function(){r.exportLoading=!0,s.get(r.config.apiEndpoint+"/export").then(function(e){r.exportLoading=!1,r.exportResponse=e.data,r.exportDownloadButton=!0})},r.exportDownload=function(){return r.exportDownloadButton=!1,window.open(r.exportResponse.url),!1},r.applySaveCallback=function(){r.config.saveCallback&&e.invoke(r.config.saveCallback,this)},r.showCrudList=!0,r.isOrderBy=function(e){return e==r.config.orderBy},r.changeOrder=function(e,t){r.config.orderBy=t+e,s.post("admin/api-admin-common/ngrest-order",{apiEndpoint:r.config.apiEndpoint,sort:t,field:e},{ignoreLoadingBar:!0}),r.pager&&!r.config.pagerHiddenByAjaxSearch?r.loadList(1):r.data.listArray=a("orderBy")(r.data.listArray,t+e)},r.reApplyOrder=function(){r.data.listArray=a("orderBy")(r.data.listArray,r.config.orderBy)},r.reloadActiveWindow=function(){r.getActiveWindow(r.data.aw.hash,r.data.aw.itemId)},r.getActiveWindow=function(t,n,e){s.post(r.config.activeWindowRenderUrl,$.param({itemId:n,activeWindowHash:t,ngrestConfigHash:r.config.ngrestConfigHash}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){r.openActiveWindow(),r.data.aw.itemId=n,r.data.aw.configCallbackUrl=r.config.activeWindowCallbackUrl,r.data.aw.configHash=r.config.ngrestConfigHash,r.data.aw.hash=t,r.data.aw.content=i.trustAsHtml(e.data.content),r.data.aw.title=e.data.label,r.$broadcast("awloaded",{id:t})})},r.getActiveWindowCallbackUrl=function(e){return r.data.aw.configCallbackUrl+"?activeWindowCallback="+e+"&ngrestConfigHash="+r.data.aw.configHash+"&activeWindowHash="+r.data.aw.hash},r.sendActiveWindowCallback=function(e,t){t=t||{};return s.post(r.getActiveWindowCallbackUrl(e),$.param(t),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})},r.$watch("config.searchQuery",function(e,t){e!=t&&null!=e&&null!=e&&r.applySearchQuery(e)}),r.applySearchQuery=function(t){if(null!=t&&null!=t){var n=!1;if(r.pager)if(0==t.length)l.cancel(r.searchPromise),r.data.listArray=r.data.list,r.config.pagerHiddenByAjaxSearch=!1;else{if(l.cancel(r.searchPromise),n)return;r.searchPromise=l(function(){n=!0,s.post(r.config.apiEndpoint+"/full-response?"+r.config.apiListQueryString,{query:t}).then(function(e){r.config.pagerHiddenByAjaxSearch=!0,n=!1,r.config.fullSearchContainer=e.data,r.data.listArray=a("filter")(e.data,t)})},500)}else r.config.pagerHiddenByAjaxSearch=!1,r.data.listArray=a("filter")(r.data.list,t)}},r.reApplySearch=function(){r.applySearchQuery(r.config.searchQuery)},r.parentSelectInline=function(e){r.$parent.$parent.$parent.setModelValue(r.getRowPrimaryValue(e),e)},r.checkIfFieldExistsInParentRelation=function(e){if(r.config.relationCall){var t=r.$parent.$parent.config.relations[parseInt(r.config.relationCall.arrayIndex)].relationLink;if(null!==t&&t.hasOwnProperty(e))return parseInt(r.config.relationCall.id)}return!1},r.relationItems=[],r.deleteItem=function(e,t){c.confirm(i18n.js_ngrest_rm_page,i18n.ngrest_button_delete,["$toast",function(t){s.delete(r.config.apiEndpoint+"/"+e).then(function(e){r.loadList(),t.close(),c.success(i18n.js_ngrest_rm_confirm)},function(e){r.printErrors(e)})}])},r.toggleUpdate=function(n){r.resetData(),s.get(r.config.apiEndpoint+"/"+n+"?"+r.config.apiUpdateQueryString).then(function(e){var t=e.data;r.data.update=t,r.config.relationCall?r.crudSwitchType=2:r.switchTo(2),r.config.inline||o.go("default.route.detail",{id:n}),r.data.updateId=n},function(e){c.error(i18n.js_ngrest_error)})},r.submitUpdate=function(){s.put(r.config.apiEndpoint+"/"+r.data.updateId,angular.toJson(r.data.update,!0)).then(function(e){c.success(i18n.js_ngrest_rm_update),r.loadList(),r.applySaveCallback(),r.switchTo(0,!0),r.highlightItemId(r.data.updateId)},function(e){r.printErrors(e.data)})},r.submitCreate=function(){r.config.relationCall,s.post(r.config.apiEndpoint,angular.toJson(r.data.create,!0)).then(function(e){c.success(i18n.js_ngrest_rm_success),r.loadList(),r.applySaveCallback(),r.switchTo(0,!0)},function(e){r.printErrors(e.data)})},r.printErrors=function(e){angular.forEach(e,function(e,t){c.error(e.message)})},r.resetData=function(){r.data.create=angular.copy({}),r.data.update=angular.copy({})},r.highlightId=0,r.isHighlighted=function(e){return e[r.config.pk]==r.highlightId},r.highlightItemId=function(e){r.highlightId=e,l(function(){r.highlightId=0},3e3)},r.changeNgRestFilter=function(){s.post("admin/api-admin-common/ngrest-filter",{apiEndpoint:r.config.apiEndpoint,filterName:r.config.filter},{ignoreLoadingBar:!0}),r.loadList()},r.pagerPrevClick=function(){1!=r.pager.currentPage&&r.loadList(parseInt(r.pager.currentPage)-1)},r.pagerNextClick=function(){r.pager.currentPage!=r.pager.pageCount&&r.loadList(parseInt(r.pager.currentPage)+1)},r.pager=!1,r.setPagination=function(e,t,n,a){if(null!=e&&null!=t&&null!=n&&null!=a){r.totalRows=a;var i=1,o=[];for(i=1;i<=t;i++)o.push(i);r.pager={currentPage:e,pageCount:t,perPage:n,totalItems:a,pages:o}}else r.pager=!1},r.toggleStatus=function(t,n,a,e){var i=!e?1:0,o=t[r.config.pk],l={};l[n]=i,s.put(r.config.apiEndpoint+"/"+o+"?ngrestCallType=update&fields="+n,angular.toJson(l,!0)).then(function(e){t[n]=i,r.highlightItemId(o),c.success(i18nParam("js_ngrest_toggler_success",{field:a}))},function(e){r.printErrors(e)})},r.sortableUp=function(e,t,n){var a=r.data.listArray[e-1];r.data.listArray[e-1]=t,r.data.listArray[e]=a,r.updateSortableIndexPositions(n)},r.sortableDown=function(e,t,n){var a=r.data.listArray[e+1];r.data.listArray[e+1]=t,r.data.listArray[e]=a,r.updateSortableIndexPositions(n)},r.updateSortableIndexPositions=function(i){angular.forEach(r.data.listArray,function(e,t){var n={};n[i]=t;var a=e[r.config.pk];s.put(r.config.apiEndpoint+"/"+a+"?ngrestCallType=update&fields="+i,angular.toJson(n,!0),{ignoreLoadingBar:!0})})},r.loadService=function(){r.initServiceAndConfig()},r.evalSettings=function(e){e.hasOwnProperty("order")&&(r.config.orderBy=e.order),e.hasOwnProperty("filterName")&&(r.config.filter=e.filterName)},r.getRowPrimaryValue=function(e){return e[r.config.pk]},r.initServiceAndConfig=function(){var t=n.defer();return s.get(r.config.apiEndpoint+"/services").then(function(e){r.service=e.data.service,r.serviceResponse=e.data,r.evalSettings(e.data._settings),t.resolve()}),t.promise},r.getFieldHelp=function(e){return!!(r.serviceResponse&&r.serviceResponse._hints&&r.serviceResponse._hints.hasOwnProperty(e))&&r.serviceResponse._hints[e]},r.loadList=function(e){null==e&&r.pager?r.reloadCrudList(r.pager.currentPage):r.reloadCrudList(e)},r.totalRows=0,r.reloadCrudList=function(e){if(0==parseInt(r.config.filter)){if(r.config.relationCall)t=(t=r.config.apiEndpoint+"/relation-call/?"+r.config.apiListQueryString)+"&arrayIndex="+r.config.relationCall.arrayIndex+"&id="+r.config.relationCall.id+"&modelClass="+r.config.relationCall.modelClass;else var t=r.config.apiEndpoint+"/?"+r.config.apiListQueryString;void 0!==e&&(t=t+"&page="+e),r.config.orderBy&&(t=t+"&sort="+r.config.orderBy.replace("+","")),s.get(t).then(function(e){r.totalRows=e.data.length,r.setPagination(e.headers("X-Pagination-Current-Page"),e.headers("X-Pagination-Page-Count"),e.headers("X-Pagination-Per-Page"),e.headers("X-Pagination-Total-Count")),r.data.list=e.data,r.data.listArray=e.data,r.reApplyOrder(),r.reApplySearch()})}else{t=r.config.apiEndpoint+"/filter?filterName="+r.config.filter+"&"+r.config.apiListQueryString;e&&(t=t+"&page="+e),r.config.orderBy&&(t=t+"&sort="+r.config.orderBy.replace("+","")),s.get(t).then(function(e){r.totalRows=e.data.length,r.setPagination(e.headers("X-Pagination-Current-Page"),e.headers("X-Pagination-Page-Count"),e.headers("X-Pagination-Per-Page"),e.headers("X-Pagination-Total-Count")),r.data.list=e.data,r.data.listArray=e.data,r.reApplyOrder(),r.reApplySearch()})}},r.service=!1,r.data={create:{},update:{},aw:{},list:{},updateId:0},r.$watch("config",function(e,t){l(function(){r.initServiceAndConfig().then(function(){r.loadList()})})})}]),zaa.controller("ActiveWindowTagController",["$scope","$http","AdminToastService",function(n,e,a){n.crud=n.$parent,n.tags=[],n.relation={},n.newTagName=null,n.loadTags=function(){e.get(n.crud.getActiveWindowCallbackUrl("LoadTags")).then(function(e){n.tags=e.data})},n.loadRelations=function(){e.get(n.crud.getActiveWindowCallbackUrl("LoadRelations")).then(function(e){n.relation={},e.data.forEach(function(e,t){n.relation[e.tag_id]=1})})},n.saveTag=function(){var t=n.newTagName;""!==t&&n.crud.sendActiveWindowCallback("SaveTag",{tagName:t}).then(function(e){e.data?(n.tags.push({id:e.data,name:t}),a.success(t+" wurde gespeichert.")):a.error(t+" "+i18n.js_tag_exists),n.newTagName=null})},n.saveRelation=function(t,e){n.crud.sendActiveWindowCallback("SaveRelation",{tagId:t.id,value:e}).then(function(e){n.relation[t.id]=e.data,a.success(i18n.js_tag_success)})},n.$watch(function(){return n.data.aw.itemId},function(e,t){n.loadRelations()}),n.loadTags()}]),zaa.controller("ActiveWindowGalleryController",["$scope","$http","$filter",function(o,e,t){o.crud=o.$parent,o.files=[],o.select=function(e){0==t("filter")(o.files,{fileId:e},!0).length&&o.crud.sendActiveWindowCallback("AddImageToIndex",{fileId:e}).then(function(e){var t=e.data;o.files.push(t)})},o.loadImages=function(){e.get(o.crud.getActiveWindowCallbackUrl("loadAllImages")).then(function(e){o.files=e.data})},o.changePosition=function(e,t,n){t=parseInt(t);var a=o.files[t];"up"==n?(o.files[t]=o.files[t-1],o.files[t-1]=a):"down"==n&&(o.files[t]=o.files[t+1],o.files[t+1]=a);var i=o.files[t];o.crud.sendActiveWindowCallback("ChangeSortIndex",{new:i,old:a})},o.moveUp=function(e,t){o.changePosition(e,t,"up")},o.moveDown=function(e,t){o.changePosition(e,t,"down")},o.remove=function(e,t){o.crud.sendActiveWindowCallback("RemoveFromIndex",{imageId:e.originalImageId}).then(function(e){o.files.splice(t,1)})},o.$watch(function(){return o.data.aw.itemId},function(e,t){o.loadImages()})}]),zaa.controller("ActiveWindowGroupAuth",["$scope","$http","CacheReloadService",function(n,e,t){n.crud=n.$parent,n.reload=function(){t.reload()},n.rights=[],n.auths=[],n.save=function(e){n.crud.sendActiveWindowCallback("saveRights",{data:e}).then(function(e){n.getRights(),n.reload()})},n.clearModule=function(e){angular.forEach(e,function(e){n.rights[e.id]={base:0,create:0,update:0,delete:0}})},n.toggleModule=function(e){angular.forEach(e,function(e){n.rights[e.id]={base:1,create:1,update:1,delete:1}})},n.toggleGroup=function(e){objectGroup=n.rights[e],1==objectGroup.base?(objectGroup.create=1,objectGroup.update=1,objectGroup.delete=1):0==objectGroup.base&&(objectGroup.create=0,objectGroup.update=0,objectGroup.delete=0)},n.toggleAll=function(){angular.forEach(n.auths,function(e){angular.forEach(e,function(e){n.rights[e.id]={base:1,create:1,update:1,delete:1}})})},n.untoggleAll=function(){angular.forEach(n.auths,function(e){angular.forEach(e,function(e){n.rights[e.id]={base:0,create:0,update:0,delete:0}})})},n.getRights=function(){e.get(n.crud.getActiveWindowCallbackUrl("getRights")).then(function(e){n.rights=e.data.rights,n.auths=e.data.auths})},n.$on("awloaded",function(e,t){n.getRights()}),n.$watch(function(){return n.data.aw.itemId},function(e,t){n.getRights()})}]),zaa.controller("DefaultController",["$scope","$http","$state","$stateParams","CrudTabService",function(i,t,n,a,o){i.moduleId=n.params.moduleId,i.loadDashboard=function(){return i.currentItem=null,n.go("default",{moduleId:i.moduleId})},i.isOpenModulenav=!1,i.items=[],i.itemRoutes=[],i.currentItem=null,i.dashboard=[],i.itemAdd=function(e,t){for(var n in i.items.push({name:e,items:t}),t){var a=t[n];i.itemRoutes[a.route]={alias:a.alias,icon:a.icon}}},i.getDashboard=function(e){t.get("admin/api-admin-menu/dashboard",{params:{nodeId:e}}).then(function(e){i.dashboard=e.data})},i.init=function(){i.get(),i.getDashboard(i.moduleId)},i.resolveCurrentItem=function(){if(!i.currentItem&&("default.route"==n.current.name||"default.route.detail"==n.current.name)){var e=[a.moduleRouteId,a.controllerId,a.actionId].join("/");i.itemRoutes.indexOf(e)&&(i.currentItem=i.itemRoutes[e],i.currentItem.route=e)}},i.click=function(e){i.isOpenModulenav=!1;var t=(i.currentItem=e).route.split("/");o.clear(),n.go("default.route",{moduleRouteId:t[0],controllerId:t[1],actionId:t[2]})},i.get=function(){t.get("admin/api-admin-menu/items",{params:{nodeId:i.moduleId}}).then(function(e){var t=e.data;for(var n in t.groups){var a=t.groups[n];i.itemAdd(a.name,a.items)}i.resolveCurrentItem()})},i.$on("topMenuClick",function(e){i.currentItem=null}),i.init()}]),zaa.controller("DashboardController",["$scope",function(e){e.logItemOpen=!1}]),zaa.filter("lockFilter",function(){return function(e,t,n){var a=!1;return angular.forEach(e,function(e){e.lock_table==t&&e.lock_pk==n&&(a=e)}),a}}),zaa.controller("LayoutMenuController",["$scope","$document","$http","$state","$location","$timeout","$window","$filter","HtmlStorage","CacheReloadService","AdminDebugBar","LuyaLoading","AdminToastService","AdminClassService",function(i,e,n,o,t,a,l,r,s,d,c,u,f,p){i.AdminClassService=p,i.AdminDebugBar=c,i.LuyaLoading=u,i.toastQueue=f.queue,i.reload=function(){d.reload()},i.isHover=s.getValue("sidebarToggleState",!1),i.toggleMainNavSize=function(){i.isHover=!i.isHover,s.setValue("sidebarToggleState",i.isHover)},i.profile={},i.settings={},i.packages=[],i.getProfileAndSettings=function(){n.get("admin/api-admin-user/session").then(function(e){i.profile=e.data.user,i.settings=e.data.settings,i.packages=e.data.packages})},i.browser=null,i.detectBrowser=function(){i.browser=[bowser.name.replace(" ","-").toLowerCase()+"-"+bowser.version,bowser.mac?"mac-os-"+(bowser.osversion?bowser.osversion:""):"windows-"+(bowser.osversion?bowser.osversion:"")].join(" ")},i.detectBrowser(),i.getProfileAndSettings(),i.debugDetail=null,i.debugDetailKey=null,i.loadDebugDetail=function(e,t){i.debugDetail=e,i.debugDetailKey=t},i.notify=null,i.forceReload=0,i.showOnlineContainer=!1,i.searchDetailClick=function(t,a){"custom"==t.type?i.click(t.menuItem).then(function(){if(t.stateProvider){var n={};angular.forEach(t.stateProvider.params,function(e,t){n[t]=a[e]}),o.go(t.stateProvider.state,n).then(function(){i.closeSearchInput()})}else i.closeSearchInput()}):i.click(t.menuItem.module).then(function(){var e=t.menuItem.route.split("/");o.go("default.route",{moduleRouteId:e[0],controllerId:e[1],actionId:e[2]}).then(function(){if(t.stateProvider){var n={};angular.forEach(t.stateProvider.params,function(e,t){n[t]=a[e]}),o.go(t.stateProvider.state,n).then(function(){i.closeSearchInput()})}else i.closeSearchInput()})})},i.visibleAdminReloadDialog=!1,i.lastKeyStroke=Date.now(),e.bind("keyup",function(e){i.lastKeyStroke=Date.now()}),function t(){n.post("admin/api-admin-timestamp/index",{lastKeyStroke:i.lastKeyStroke},{ignoreLoadingBar:!0}).then(function(e){i.forceReload=e.data.forceReload,i.forceReload&&!i.visibleAdminReloadDialog&&(i.visibleAdminReloadDialog=!0,f.confirm(i18n.js_admin_reload,i18n.layout_btn_reload,function(){i.reload(),i.visibleAdminReloadDialog=!1})),i.locked=e.data.locked,i.notify=e.data.useronline,i.idleStrokeDashoffset=e.data.idleStrokeDashoffset,i.idleTimeRelative=e.data.idleTimeRelative,a(t,2e4)})}(),i.isLocked=function(e,t){return r("lockFilter")(i.locked,e,t)},i.getLockedName=function(e,t){var n=i.isLocked(e,t);return n.firstname+" "+n.lastname},i.searchQuery=null,i.searchInputOpen=!1,i.escapeSearchInput=function(){i.searchInputOpen&&i.closeSearchInput()},i.toggleSearchInput=function(){i.searchInputOpen=!i.searchInputOpen},i.openSearchInput=function(){i.searchInputOpen=!0},i.closeSearchInput=function(){i.searchInputOpen=!1},i.searchResponse=null,i.searchPromise=null,i.$watch(function(){return i.searchQuery},function(e,t){e!==t&&(2<e.length?(a.cancel(i.searchPromise),i.searchPromise=a(function(){n.get("admin/api-admin-search",{params:{query:e}}).then(function(e){i.searchResponse=e.data})},400)):i.searchResponse=null)}),i.items=[],i.currentItem={},i.isOpen=!1,i.click=function(e){return i.isOpen=!1,i.$broadcast("topMenuClick",{menuItem:e}),e.template?o.go("custom",{templateId:e.template}):o.go("default",{moduleId:e.id})},i.isActive=function(e){if(e.template){if(o.params.templateId==e.template)return i.currentItem=e,!0}else if(o.params.moduleId==e.id)return i.currentItem=e,!0},i.get=function(){n.get("admin/api-admin-menu").then(function(e){i.items=e.data})},i.get()}]),zaa.controller("AccountController",["$scope","$http","$window","AdminToastService",function(t,n,a,i){t.pass={},t.changePassword=function(){n.post("admin/api-admin-user/change-password",t.pass).then(function(e){i.success(i18n.aws_changepassword_succes),t.pass={}},function(e){i.errorArray(e.data),t.pass={}})},t.changeSettings=function(e){n.post("admin/api-admin-user/change-settings",e).then(function(e){a.location.reload()})},t.profile={},t.settings={},t.activities={},t.email={},t.getProfile=function(){n.get("admin/api-admin-user/session").then(function(e){t.profile=e.data.user,t.settings=e.data.settings,t.activities=e.data.activities})},t.changePersonData=function(e){n.put("admin/api-admin-user/session-update",e).then(function(e){i.success(i18n.js_account_update_profile_success),t.getProfile()},function(e){i.errorArray(e.data)})},t.changeEmail=function(){n.put("admin/api-admin-user/change-email",{token:t.email.token}).then(function(e){i.success(i18n.js_account_update_profile_success),t.getProfile()},function(e){i.errorArray(e.data)})},t.getProfile()}]);